<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸“ä¸šå¿ƒç†åˆ›ä¼¤è‡ªè¯„ç³»ç»Ÿ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ç®€åŒ–çš„CSSæ ·å¼ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary-color: #2D6A6A;
            --primary-hover: #58A8A8;
            --primary-light: #E1F0F0;
            --bg-warm: #FCFBF8;
            --bg-surface: #FFFFFF;
            --text-primary: #333333;
            --text-secondary: #6B7280;
            --border-color: #E5E7EB;
            --success-color: #28A745;
            --warning-color: #FFC107;
            --error-color: #DC3545;
            --font-heading: 'Poppins', sans-serif;
            --font-body: 'Inter', sans-serif;
            --space-xs: 8px;
            --space-sm: 16px;
            --space-md: 24px;
            --space-lg: 32px;
            --space-xl: 48px;
            --space-xxl: 64px;
            --space-xxxl: 96px;
            --border-radius: 12px;
            --shadow-card: 0 4px 12px rgba(45, 106, 106, 0.08);
            --shadow-button: 0 2px 4px rgba(0, 0, 0, 0.1);
            --transition-smooth: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-quick: all 0.2s ease-in-out;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-warm);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
            min-height: 100vh;
        }

        .page-container { display: none; min-height: 100vh; padding: var(--space-md); }
        .page-container.active { display: block; }

        .hero-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-xxxl) var(--space-md);
        }

        .hero-content {
            max-width: 768px;
            text-align: center;
        }

        .hero-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 48px;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .hero-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: var(--space-xl);
            line-height: 1.8;
        }

        .disclaimer {
            background-color: #FFFBEB;
            border: 1px solid #FED7AA;
            border-radius: var(--border-radius);
            padding: var(--space-md);
            margin: var(--space-xl) 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            text-align: left;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .test-info {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            margin: var(--space-xl) 0;
            flex-wrap: wrap;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-secondary);
            font-size: 14px;
        }

        .cta-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: var(--space-md) var(--space-xl);
            font-size: 16px;
            font-weight: 500;
            font-family: var(--font-heading);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            box-shadow: var(--shadow-button);
            min-width: 220px;
            min-height: 56px;
        }

        .cta-button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(45, 106, 106, 0.2);
        }

        .test-container {
            max-width: 768px;
            margin: 0 auto;
            padding: var(--space-xl) 0;
        }

        .progress-section {
            margin-bottom: var(--space-xl);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--primary-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: var(--space-sm);
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .question-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
            margin-bottom: var(--space-xl);
        }

        .question-header {
            margin-bottom: var(--space-lg);
        }

        .question-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            line-height: 1.3;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .dimension-tag {
            display: inline-block;
            background-color: var(--primary-light);
            color: var(--primary-color);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .question-content {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
            line-height: 1.6;
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .option-item {
            background-color: var(--bg-warm);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--space-md);
            cursor: pointer;
            transition: var(--transition-quick);
            position: relative;
        }

        .option-item:hover {
            border-color: var(--primary-light);
            background-color: var(--primary-light);
        }

        .option-item.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
            color: var(--primary-color);
        }

        .option-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .option-label {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            font-size: 15px;
            line-height: 1.5;
        }

        .option-radio {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            position: relative;
            transition: var(--transition-quick);
        }

        .option-item.selected .option-radio {
            border-color: var(--primary-color);
        }

        .option-radio::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .option-item.selected .option-radio::after {
            opacity: 1;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            margin-top: var(--space-xl);
        }

        .nav-button {
            padding: var(--space-md) var(--space-lg);
            font-size: 16px;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            min-width: 120px;
            border: 2px solid transparent;
        }

        .nav-button.primary {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .nav-button.primary:hover:not(:disabled) {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }

        .nav-button.secondary {
            background-color: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .nav-button.secondary:hover:not(:disabled) {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result-container {
            max-width: 1024px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-md);
        }

        .result-header {
            text-align: center;
            margin-bottom: var(--space-xxxl);
        }

        .result-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 36px;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
        }

        .result-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .summary-section {
            margin-bottom: var(--space-xxxl);
        }

        .summary-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
            text-align: center;
        }

        .overall-score {
            margin: var(--space-lg) 0;
        }

        .score-number {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 64px;
            color: var(--primary-color);
            line-height: 1;
            margin-bottom: var(--space-sm);
        }

        .score-label {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .score-description {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        .chart-section {
            margin-bottom: var(--space-xxxl);
        }

        .chart-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
            text-align: center;
        }

        .chart-container {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
            max-width: 600px;
            margin: 0 auto;
        }

        #trauma-radar-chart {
            max-height: 400px;
        }

        .details-section {
            margin-bottom: var(--space-xxxl);
        }

        .details-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
        }

        .detail-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
        }

        .detail-card h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .score-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-sm);
        }

        .score-badge {
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .score-badge.low { background-color: #D1FAE5; color: #065F46; }
        .score-badge.medium { background-color: #FEF3C7; color: #92400E; }
        .score-badge.high { background-color: #FEE2E2; color: #991B1B; }
        .score-badge.severe { background-color: #FECACA; color: #7F1D1D; }

        .detail-card p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .recommendations-section {
            margin-bottom: var(--space-xxxl);
        }

        .recommendations-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .recommendations-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
        }

        .recommendation-item {
            padding: var(--space-md) 0;
            border-bottom: 1px solid var(--border-color);
        }

        .recommendation-item:last-child {
            border-bottom: none;
        }

        .recommendation-item h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .recommendation-item p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .resources-section {
            margin-bottom: var(--space-xxxl);
        }

        .resources-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
        }

        .resource-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
            text-align: center;
        }

        .resource-card h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .resource-card p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
            margin-bottom: var(--space-md);
        }

        .resource-card a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--primary-color);
            border-radius: var(--border-radius);
            transition: var(--transition-quick);
            display: inline-block;
        }

        .resource-card a:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .crisis-number {
            font-weight: 600;
            color: var(--error-color);
            font-size: 16px;
        }

        .result-actions {
            text-align: center;
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .action-button {
            padding: var(--space-md) var(--space-lg);
            font-size: 16px;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            min-width: 180px;
            border: 2px solid transparent;
        }

        .action-button.primary {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .action-button.primary:hover {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }

        .action-button.secondary {
            background-color: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .action-button.secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50vh;
            font-size: 18px;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .hero-title { font-size: 32px; }
            .hero-subtitle { font-size: 16px; }
            .test-info { flex-direction: column; gap: var(--space-md); }
            .question-title { font-size: 20px; }
            .result-title { font-size: 28px; }
            .score-number { font-size: 48px; }
            .details-grid { grid-template-columns: 1fr; }
            .resources-grid { grid-template-columns: 1fr; }
            .result-actions { flex-direction: column; align-items: center; }
            .navigation { flex-direction: column; }
        }

        @media (max-width: 480px) {
            .page-container { padding: var(--space-sm); }
            .hero-section { padding: var(--space-xxl) var(--space-sm); }
            .hero-title { font-size: 28px; }
            .question-card { padding: var(--space-md); }
            .summary-card, .chart-container, .recommendations-card { padding: var(--space-lg); }
        }
    </style>
</head>
<body>
    <!-- é”™è¯¯æç¤ºåŒºåŸŸ -->
    <div id="error-message" style="display: none; position: fixed; top: 20px; right: 20px; background: #ff4444; color: white; padding: 15px; border-radius: 8px; z-index: 9999;"></div>

    <!-- æµ‹è¯•ä»‹ç»é¡µé¢ -->
    <div id="intro-page" class="page-container active">
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">ä¸“ä¸šå¿ƒç†åˆ›ä¼¤è‡ªè¯„</h1>
                <p class="hero-subtitle">
                    ä¸€æ¬¡æ·±åº¦çš„è‡ªæˆ‘æ¢ç´¢ä¹‹æ—…ï¼Œäº†è§£æ‚¨å¯èƒ½å­˜åœ¨çš„å¿ƒç†åˆ›ä¼¤ç±»å‹åŠå…¶å½±å“ã€‚
                    æœ¬ç³»ç»ŸåŸºäºå¿ƒç†å­¦ä¸“ä¸šé‡è¡¨ï¼Œä¸ºæ‚¨æä¾›ä¸ªæ€§åŒ–çš„åˆ†ææŠ¥å‘Šã€‚
                </p>
                
                <div class="disclaimer">
                    <span>âš ï¸ æœ¬æµ‹è¯•ä»…ä¸ºè‡ªè¯„å·¥å…·ï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šå¿ƒç†è¯Šæ–­ã€‚å¦‚æœ‰ä¸¥é‡å¿ƒç†å›°æ‰°ï¼Œè¯·å¯»æ±‚ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡ã€‚</span>
                </div>

                <div class="test-info">
                    <div class="info-item">
                        <span>â±ï¸ é¢„è®¡ç”¨æ—¶ï¼š15-20åˆ†é’Ÿ</span>
                    </div>
                    <div class="info-item">
                        <span>ğŸ”’ å®Œå…¨åŒ¿åä¿å¯†</span>
                    </div>
                </div>

                <button class="cta-button" onclick="startTest()">å¼€å§‹è¯„ä¼°</button>
            </div>
        </div>
    </div>

    <!-- æµ‹è¯•é¡µé¢ -->
    <div id="test-page" class="page-container">
        <div class="test-container">
            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span id="current-question">1</span> / <span id="total-questions">32</span>
                </div>
            </div>

            <div class="question-card" id="question-card">
                <div class="question-header">
                    <h2 class="question-title" id="question-title"></h2>
                    <div class="dimension-tag" id="dimension-tag"></div>
                </div>
                <div class="question-content" id="question-content"></div>
                <div class="question-options" id="question-options"></div>
            </div>

            <div class="navigation">
                <button class="nav-button secondary" id="prev-btn" onclick="previousQuestion()" disabled>
                    ä¸Šä¸€é¢˜
                </button>
                <button class="nav-button primary" id="next-btn" onclick="nextQuestion()" disabled>
                    ä¸‹ä¸€é¢˜
                </button>
            </div>
        </div>
    </div>

    <!-- ç»“æœé¡µé¢ -->
    <div id="result-page" class="page-container">
        <div class="result-container">
            <div class="result-header">
                <h1 class="result-title">æ‚¨çš„åˆ›ä¼¤è¯„ä¼°æŠ¥å‘Š</h1>
                <p class="result-subtitle">åŸºäºæ‚¨çš„å›ç­”ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†çš„ä¸“ä¸šåˆ†æ</p>
            </div>

            <div class="summary-section">
                <div class="summary-card">
                    <h3>æ€»ä½“è¯„ä¼°</h3>
                    <div class="overall-score">
                        <div class="score-number" id="overall-score">0</div>
                        <div class="score-label">æ€»ä½“é£é™©æŒ‡æ•°</div>
                    </div>
                    <div class="score-description" id="score-description"></div>
                </div>
            </div>

            <div class="chart-section">
                <h3>å„ç»´åº¦é£é™©åˆ†å¸ƒ</h3>
                <div class="chart-container">
                    <canvas id="trauma-radar-chart"></canvas>
                </div>
            </div>

            <div class="details-section">
                <h3>è¯¦ç»†åˆ†æ</h3>
                <div class="details-grid" id="details-grid">
                    <!-- åŠ¨æ€ç”Ÿæˆè¯¦ç»†å†…å®¹å¡ç‰‡ -->
                </div>
            </div>

            <div class="recommendations-section">
                <h3>ä¸“ä¸šå»ºè®®</h3>
                <div class="recommendations-card" id="recommendations-card">
                    <!-- åŠ¨æ€ç”Ÿæˆå»ºè®®å†…å®¹ -->
                </div>
            </div>

            <div class="resources-section">
                <h3>æ”¯æŒèµ„æº</h3>
                <div class="resources-grid">
                    <div class="resource-card">
                        <h4>ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡</h4>
                        <p>å¦‚æœæ‚¨çš„åˆ›ä¼¤è¯„åˆ†è¾ƒé«˜ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆçš„å¸®åŠ©</p>
                        <a href="https://www.psyche.com.cn" target="_blank" rel="noopener">å¯»æ‰¾å’¨è¯¢å¸ˆ</a>
                    </div>
                    <div class="resource-card">
                        <h4>ç´§æ€¥å±æœºå¹²é¢„</h4>
                        <p>å¦‚æœ‰è‡ªæ€å€¾å‘æˆ–ä¸¥é‡å¿ƒç†å±æœºï¼Œè¯·ç«‹å³å¯»æ±‚å¸®åŠ©</p>
                        <p class="crisis-number">24å°æ—¶å±æœºçƒ­çº¿ï¼š400-161-9995</p>
                    </div>
                    <div class="resource-card">
                        <h4>æ”¯æŒç¾¤ä½“</h4>
                        <p>åŠ å…¥åˆ›ä¼¤åº·å¤æ”¯æŒå°ç»„ï¼Œä¸æœ‰ç›¸ä¼¼ç»å†çš„äººåˆ†äº«</p>
                        <a href="#" onclick="alert('å®é™…åº”ç”¨ä¸­å¯é“¾æ¥åˆ°ç›¸å…³æ”¯æŒç¾¤ä½“ç½‘ç«™')">äº†è§£æ›´å¤š</a>
                    </div>
                </div>
            </div>

            <div class="result-actions">
                <button class="action-button primary" onclick="downloadReport()">
                    ä¸‹è½½å®Œæ•´æŠ¥å‘Š
                </button>
                <button class="action-button secondary" onclick="restartTest()">
                    é‡æ–°æµ‹è¯•
                </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentQuestionIndex = 0;
        let answers = {};
        let testCompleted = false;
        let chartInstance = null;

        // DOM å…ƒç´ 
        const elements = {
            introPage: document.getElementById('intro-page'),
            testPage: document.getElementById('test-page'),
            resultPage: document.getElementById('result-page'),
            progressFill: document.getElementById('progress-fill'),
            currentQuestionSpan: document.getElementById('current-question'),
            totalQuestionsSpan: document.getElementById('total-questions'),
            questionTitle: document.getElementById('question-title'),
            questionContent: document.getElementById('question-content'),
            questionOptions: document.getElementById('question-options'),
            dimensionTag: document.getElementById('dimension-tag'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            overallScore: document.getElementById('overall-score'),
            scoreDescription: document.getElementById('score-description'),
            detailsGrid: document.getElementById('details-grid'),
            recommendationsCard: document.getElementById('recommendations-card'),
            errorMessage: document.getElementById('error-message')
        };

        // æµ‹è¯•æ•°æ® - ç®€åŒ–ç‰ˆæœ¬
        const testData = {
            dimensions: [
                {
                    id: 'childhood',
                    name: 'ç«¥å¹´æœŸåˆ›ä¼¤',
                    description: 'ç«¥å¹´æ—¶æœŸå¯èƒ½é­å—çš„å„ç§åˆ›ä¼¤ç»å†',
                    questions: [
                        { id: 1, text: 'åœ¨æ‚¨çš„ç«¥å¹´æ—¶æœŸï¼Œæ˜¯å¦ç»å¸¸å—åˆ°èº«ä½“ä¸Šçš„æƒ©ç½šæˆ–è™å¾…ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 2, text: 'æ‚¨æ˜¯å¦åœ¨ç«¥å¹´æ—¶æœŸé­å—è¿‡æ€§æ–¹é¢çš„ä¾µçŠ¯æˆ–ä¸å½“æ¥è§¦ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å‘ç”Ÿè¿‡ä¸€æ¬¡'}, {value: 2, text: 'å‘ç”Ÿå¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸæŒç»­'}] },
                        { id: 3, text: 'æ‚¨çš„ç«¥å¹´ç›‘æŠ¤äººæ˜¯å¦ç»å¸¸å¯¹æ‚¨è¿›è¡Œæƒ…æ„Ÿä¸Šçš„ç¾è¾±ã€è´¬æŸæˆ–å¨èƒï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 4, text: 'æ‚¨çš„ç«¥å¹´å®¶åº­æ˜¯å¦ç»å¸¸å……æ»¡äº‰åµã€æš´åŠ›æˆ–ä¸ç¨³å®šçš„æƒ…å†µï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] }
                    ]
                },
                {
                    id: 'emotional',
                    name: 'æƒ…æ„Ÿåˆ›ä¼¤',
                    description: 'æˆäººåå¯èƒ½é­å—çš„æƒ…æ„Ÿå…³ç³»åˆ›ä¼¤',
                    questions: [
                        { id: 5, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡ä¼´ä¾£çš„èƒŒå›æˆ–æ¬ºéª—ï¼Œè®©æ‚¨æ„Ÿåˆ°æ·±æ·±çš„ä¼¤å®³ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'ç»å¸¸å‘ç”Ÿ'}] },
                        { id: 6, text: 'æ‚¨æ˜¯å¦æ›¾ç»è¢«äº²å¯†çš„äººä¸¥é‡ä¼¤å®³ã€ç¾è¾±æˆ–æ”»å‡»ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'ç»å¸¸å‘ç”Ÿ'}] },
                        { id: 7, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡é•¿æœŸçš„æƒ…æ„Ÿæ“æ§æˆ–ç²¾ç¥è™å¾…ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æ—¶é—´è¾ƒçŸ­'}, {value: 2, text: 'æ—¶é—´è¾ƒé•¿'}, {value: 3, text: 'æŒç»­å¤šå¹´'}] },
                        { id: 8, text: 'æ‚¨æ˜¯å¦æ›¾ç»è¢«é‡è¦çš„äººé—å¼ƒæˆ–çªç„¶å¤±å»äº²å¯†å…³ç³»ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'ç»å¸¸å‘ç”Ÿ'}] }
                    ]
                },
                {
                    id: 'interpersonal',
                    name: 'äººé™…å…³ç³»åˆ›ä¼¤',
                    description: 'ç¤¾äº¤å’Œäººé™…å…³ç³»ä¸­çš„è´Ÿé¢ç»å†',
                    questions: [
                        { id: 9, text: 'æ‚¨æ˜¯å¦æ›¾ç»é­å—è¿‡ä¸¥é‡çš„æ ¡å›­éœ¸å‡Œæˆ–èŒåœºæ¬ºå‡Œï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'é•¿æœŸæŒç»­'}] },
                        { id: 10, text: 'æ‚¨æ˜¯å¦æ›¾ç»åœ¨ç¤¾äº¤åœºåˆç»å¸¸è¢«å˜²ç¬‘ã€æ’æ–¥æˆ–è¾¹ç¼˜åŒ–ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 11, text: 'æ‚¨æ˜¯å¦æ›¾ç»å› ä¸ºå¤–è²Œã€èº«ä»½æˆ–èƒŒæ™¯è€Œé­å—æ­§è§†æˆ–ä¸å…¬å¹³å¯¹å¾…ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 12, text: 'æ‚¨æ˜¯å¦æ›¾ç»è¢«è¿«å¤„äºè¢«äººé™…å…³ç³»å­¤ç«‹æˆ–æ’æŒ¤çš„çŠ¶æ€ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸç»å†'}] }
                    ]
                },
                {
                    id: 'acute',
                    name: 'æ€¥æ€§åˆ›ä¼¤',
                    description: 'çªå‘äº‹ä»¶é€ æˆçš„åˆ›ä¼¤ä½“éªŒ',
                    questions: [
                        { id: 13, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡ä¸¥é‡çš„æ„å¤–äº‹æ•…æˆ–ç¾éš¾äº‹ä»¶ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'ç»å†è¿‡ä¸€æ¬¡'}, {value: 2, text: 'ç»å†è¿‡å¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸå½±å“'}] },
                        { id: 14, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç›®å‡»è¿‡ä¸¥é‡çš„æš´åŠ›äº‹ä»¶æˆ–æ­»äº¡åœºé¢ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'ç›®å‡»è¿‡ä¸€æ¬¡'}, {value: 2, text: 'ç›®å‡»è¿‡å¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸå½±å“'}] },
                        { id: 15, text: 'æ‚¨æ˜¯å¦æ›¾ç»è¢«è¯Šæ–­æ‚£æœ‰ä¸¥é‡çš„èº«ä½“ç–¾ç—…æˆ–ç»å†è¿‡ç”Ÿå‘½å±é™©ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'æ…¢æ€§ç–¾ç—…'}] },
                        { id: 16, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡é‡å¤§çš„ç»æµæŸå¤±æˆ–è´¢åŠ¡å±æœºï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸå›°æ‰°'}] }
                    ]
                },
                {
                    id: 'chronic',
                    name: 'æ…¢æ€§å‹åŠ›',
                    description: 'é•¿æœŸæŒç»­çš„å‹åŠ›å’Œåˆ›ä¼¤çŠ¶æ€',
                    questions: [
                        { id: 17, text: 'æ‚¨æ˜¯å¦ç»å†è¿‡é•¿æœŸçš„èŒåœºå‹åŠ›ã€å·¥ä½œè™å¾…æˆ–å¤±ä¸šå›°éš¾ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æ—¶é—´è¾ƒçŸ­'}, {value: 2, text: 'æ—¶é—´è¾ƒé•¿'}, {value: 3, text: 'æŒç»­å¤šå¹´'}] },
                        { id: 18, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡ç»æµå›°å¢ƒã€è´«å›°æˆ–å€ºåŠ¡å‹åŠ›ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'çŸ­æœŸå›°éš¾'}, {value: 2, text: 'é•¿æœŸå›°éš¾'}, {value: 3, text: 'æç«¯å›°éš¾'}] },
                        { id: 19, text: 'æ‚¨æ˜¯å¦æ›¾ç»éœ€è¦é•¿æœŸç…§é¡¾é‡ç—…çš„å®¶äººæˆ–æœ‹å‹ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'çŸ­æœŸç…§æŠ¤'}, {value: 2, text: 'é•¿æœŸç…§æŠ¤'}, {value: 3, text: 'é•¿æœŸç…§é¡¾'}] },
                        { id: 20, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡æ…¢æ€§å¥åº·é—®é¢˜æˆ–èº«ä½“ç–¼ç—›ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æŒç»­å­˜åœ¨'}] }
                    ]
                },
                {
                    id: 'complex',
                    name: 'å¤åˆæ€§åˆ›ä¼¤',
                    description: 'å¤šé‡å’Œå¤æ‚çš„åˆ›ä¼¤ç»å†',
                    questions: [
                        { id: 21, text: 'æ‚¨æ˜¯å¦æ›¾ç»åŒæ—¶ç»å†å¤šç§ç±»å‹çš„åˆ›ä¼¤äº‹ä»¶ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 22, text: 'æ‚¨æ˜¯å¦æ›¾ç»é­å—è¿‡é•¿æœŸçš„äººèº«å®‰å…¨å¨èƒï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'é•¿æœŸå¨èƒ'}] },
                        { id: 23, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡æ¶‰åŠå¤šä¸ªä¾µå®³è€…çš„åˆ›ä¼¤äº‹ä»¶ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'ç»å¸¸å‘ç”Ÿ'}] },
                        { id: 24, text: 'æ‚¨æ˜¯å¦æ›¾ç»åœ¨åˆ›ä¼¤åæ„Ÿåˆ°å¤±å»å¯¹ç”Ÿæ´»çš„æ§åˆ¶æ„Ÿï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] }
                    ]
                },
                {
                    id: 'vicarious',
                    name: 'æ¬¡çº§åˆ›ä¼¤',
                    description: 'é€šè¿‡ä»–äººç»å†çš„åˆ›ä¼¤é—´æ¥ä½“éªŒ',
                    questions: [
                        { id: 25, text: 'æ‚¨æ˜¯å¦æ›¾ç»å› ä¸ºäº²çœ¼è§è¯ä»–äººçš„åˆ›ä¼¤è€Œæ„Ÿåˆ°ç—›è‹¦ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'æœ‰è¿‡ä¸€æ¬¡'}, {value: 2, text: 'æœ‰è¿‡å¤šæ¬¡'}, {value: 3, text: 'ç»å¸¸å‘ç”Ÿ'}] },
                        { id: 26, text: 'æ‚¨æ˜¯å¦æ›¾ç»å› ä¸ºéœ€è¦ç…§é¡¾åˆ›ä¼¤å—å®³è€…è€Œæ„Ÿåˆ°èº«å¿ƒç–²æƒ«ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”æ„Ÿåˆ°'}, {value: 2, text: 'ç»å¸¸æ„Ÿåˆ°'}, {value: 3, text: 'æŒç»­æ„Ÿåˆ°'}] },
                        { id: 27, text: 'æ‚¨æ˜¯å¦æ›¾ç»å› ä¸ºå·¥ä½œæˆ–å¿—æ„¿æ´»åŠ¨æš´éœ²äºåˆ›ä¼¤å†…å®¹è€Œå—åˆ°å½±å“ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'çŸ­æœŸå½±å“'}, {value: 2, text: 'é•¿æœŸå½±å“'}, {value: 3, text: 'ä¸¥é‡å½±å“'}] },
                        { id: 28, text: 'æ‚¨æ˜¯å¦æ›¾ç»å› ä¸ºä»–äººçš„ç—›è‹¦è€Œæ„Ÿåˆ°å†…ç–šæˆ–æ— åŠ©ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”æ„Ÿåˆ°'}, {value: 2, text: 'ç»å¸¸æ„Ÿåˆ°'}, {value: 3, text: 'æŒç»­æ„Ÿåˆ°'}] }
                    ]
                },
                {
                    id: 'attachment',
                    name: 'ä¾æ‹åˆ›ä¼¤',
                    description: 'æ—©æœŸä¾æ‹å…³ç³»ä¸­çš„åˆ›ä¼¤ä½“éªŒ',
                    questions: [
                        { id: 29, text: 'æ‚¨æ˜¯å¦æ›¾ç»åœ¨ç«¥å¹´æ—¶æœŸç¼ºä¹ç¨³å®šçš„å…³çˆ±å’Œç…§é¡¾ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”ç¼ºä¹'}, {value: 2, text: 'ç»å¸¸ç¼ºä¹'}, {value: 3, text: 'æ€»æ˜¯ç¼ºä¹'}] },
                        { id: 30, text: 'æ‚¨æ˜¯å¦æ›¾ç»ç»å†è¿‡æ¥è‡ªä¸»è¦ç…§é¡¾è€…çš„æƒ…æ„Ÿç–ç¦»æˆ–å†·æ¼ ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 31, text: 'æ‚¨æ˜¯å¦æ›¾ç»æ„Ÿè§‰è‡ªå·±çš„éœ€æ±‚ç»å¸¸è¢«å¿½è§†æˆ–æ‹’ç»ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”å‘ç”Ÿ'}, {value: 2, text: 'ç»å¸¸å‘ç”Ÿ'}, {value: 3, text: 'æ€»æ˜¯å‘ç”Ÿ'}] },
                        { id: 32, text: 'æ‚¨æ˜¯å¦æ›¾ç»åœ¨ç«¥å¹´æ—¶æœŸç»å¸¸æ„Ÿåˆ°ä¸å®‰å…¨æˆ–ç„¦è™‘ï¼Ÿ', options: [{value: 0, text: 'ä»æœªæœ‰è¿‡'}, {value: 1, text: 'å¶å°”æ„Ÿåˆ°'}, {value: 2, text: 'ç»å¸¸æ„Ÿåˆ°'}, {value: 3, text: 'æ€»æ˜¯æ„Ÿåˆ°'}] }
                    ]
                }
            ]
        };

        // é”™è¯¯å¤„ç†å‡½æ•°
        function showError(message) {
            console.error('Error:', message);
            elements.errorMessage.textContent = message;
            elements.errorMessage.style.display = 'block';
            setTimeout(() => {
                elements.errorMessage.style.display = 'none';
            }, 5000);
        }

        // è·å–æ‰€æœ‰é—®é¢˜
        function getAllQuestions() {
            const allQuestions = [];
            testData.dimensions.forEach(dimension => {
                dimension.questions.forEach(question => {
                    allQuestions.push({
                        ...question,
                        dimension: dimension.id,
                        dimensionName: dimension.name,
                        dimensionDescription: dimension.description
                    });
                });
            });
            return allQuestions;
        }

        // åˆå§‹åŒ–æµ‹è¯•
        function initTest() {
            try {
                const allQuestions = getAllQuestions();
                elements.totalQuestionsSpan.textContent = allQuestions.length;
                currentQuestionIndex = 0;
                answers = {};
                testCompleted = false;
                console.log('Test initialized with', allQuestions.length, 'questions');
            } catch (error) {
                showError('åˆå§‹åŒ–æµ‹è¯•æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // å¼€å§‹æµ‹è¯•
        function startTest() {
            try {
                console.log('Starting test...');
                initTest();
                showPage('test');
                displayCurrentQuestion();
                updateProgress();
            } catch (error) {
                showError('å¼€å§‹æµ‹è¯•æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºé¡µé¢
        function showPage(pageName) {
            try {
                elements.introPage.classList.remove('active');
                elements.testPage.classList.remove('active');
                elements.resultPage.classList.remove('active');
                
                if (pageName === 'intro') {
                    elements.introPage.classList.add('active');
                } else if (pageName === 'test') {
                    elements.testPage.classList.add('active');
                } else if (pageName === 'result') {
                    elements.resultPage.classList.add('active');
                }
                console.log('Showing page:', pageName);
            } catch (error) {
                showError('åˆ‡æ¢é¡µé¢æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºå½“å‰é¢˜ç›®
        function displayCurrentQuestion() {
            try {
                const allQuestions = getAllQuestions();
                const question = allQuestions[currentQuestionIndex];
                
                if (!question) {
                    console.error('No question found for index:', currentQuestionIndex);
                    return;
                }
                
                console.log('Displaying question:', question.id, question.text);
                
                // æ›´æ–°é¢˜ç›®å†…å®¹
                elements.questionTitle.textContent = `é¢˜ç›® ${currentQuestionIndex + 1}`;
                elements.questionContent.textContent = question.text;
                elements.dimensionTag.textContent = question.dimensionName;
                
                // æ¸…ç©ºå¹¶åˆ›å»ºé€‰é¡¹
                elements.questionOptions.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option-item';
                    
                    if (answers[question.id] === option.value) {
                        optionDiv.classList.add('selected');
                    }
                    
                    optionDiv.innerHTML = `
                        <input type="radio" name="question_${question.id}" value="${option.value}" 
                               ${answers[question.id] === option.value ? 'checked' : ''}>
                        <label class="option-label">
                            <span class="option-radio"></span>
                            ${option.text}
                        </label>
                    `;
                    
                    optionDiv.addEventListener('click', () => {
                        selectOption(question.id, option.value);
                    });
                    
                    elements.questionOptions.appendChild(optionDiv);
                });
                
                updateNavigationButtons();
            } catch (error) {
                showError('æ˜¾ç¤ºé¢˜ç›®æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(questionId, value) {
            try {
                console.log('Selecting option:', questionId, value);
                answers[questionId] = value;
                
                // æ›´æ–°UI
                const optionDivs = elements.questionOptions.querySelectorAll('.option-item');
                optionDivs.forEach(div => div.classList.remove('selected'));
                
                const selectedDiv = Array.from(optionDivs).find(div => {
                    const input = div.querySelector('input[type="radio"]');
                    return input && parseInt(input.value) === value;
                });
                
                if (selectedDiv) {
                    selectedDiv.classList.add('selected');
                }
                
                updateNavigationButtons();
            } catch (error) {
                showError('é€‰æ‹©é€‰é¡¹æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ›´æ–°å¯¼èˆªæŒ‰é’®
        function updateNavigationButtons() {
            const allQuestions = getAllQuestions();
            
            // æ›´æ–°å‰ä¸€é¢˜æŒ‰é’®
            elements.prevBtn.disabled = currentQuestionIndex === 0;
            
            // æ›´æ–°ä¸‹ä¸€é¢˜æŒ‰é’®
            const currentQuestion = allQuestions[currentQuestionIndex];
            const hasAnswer = currentQuestion && answers[currentQuestion.id] !== undefined;
            
            if (currentQuestionIndex === allQuestions.length - 1) {
                elements.nextBtn.textContent = 'æŸ¥çœ‹ç»“æœ';
                elements.nextBtn.disabled = !hasAnswer;
            } else {
                elements.nextBtn.textContent = 'ä¸‹ä¸€é¢˜';
                elements.nextBtn.disabled = !hasAnswer;
            }
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const allQuestions = getAllQuestions();
            const progress = ((currentQuestionIndex) / allQuestions.length) * 100;
            elements.progressFill.style.width = progress + '%';
            elements.currentQuestionSpan.textContent = currentQuestionIndex + 1;
        }

        // ä¸Šä¸€é¢˜
        function previousQuestion() {
            try {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayCurrentQuestion();
                    updateProgress();
                }
            } catch (error) {
                showError('ä¸Šä¸€é¢˜æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            try {
                const allQuestions = getAllQuestions();
                
                if (currentQuestionIndex === allQuestions.length - 1) {
                    // æ˜¾ç¤ºç»“æœ
                    showResults();
                } else {
                    currentQuestionIndex++;
                    displayCurrentQuestion();
                    updateProgress();
                }
            } catch (error) {
                showError('ä¸‹ä¸€é¢˜æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function showResults() {
            try {
                console.log('Showing results...');
                testCompleted = true;
                showPage('result');
                generateResults();
            } catch (error) {
                showError('æ˜¾ç¤ºç»“æœæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆç»“æœ
        function generateResults() {
            try {
                // è®¡ç®—å„ç»´åº¦å¾—åˆ†
                const dimensionScores = {};
                testData.dimensions.forEach(dimension => {
                    const dimensionAnswers = dimension.questions.map(q => answers[q.id] || 0);
                    const avgScore = dimensionAnswers.reduce((sum, score) => sum + score, 0) / dimensionAnswers.length;
                    dimensionScores[dimension.id] = avgScore;
                });
                
                // è®¡ç®—æ€»ä½“å¾—åˆ†
                const overallScore = Math.round(
                    Object.values(dimensionScores).reduce((sum, score) => sum + score, 0) / testData.dimensions.length * 20
                );
                
                // æ›´æ–°æ€»ä½“è¯„ä¼°
                elements.overallScore.textContent = overallScore;
                elements.scoreDescription.textContent = getOverallDescription(overallScore);
                
                // ç”Ÿæˆé›·è¾¾å›¾
                generateRadarChart(dimensionScores);
                
                // ç”Ÿæˆè¯¦ç»†åˆ†æ
                generateDetails(dimensionScores);
                
                // ç”Ÿæˆå»ºè®®
                generateRecommendations(dimensionScores);
                
                console.log('Results generated successfully');
            } catch (error) {
                showError('ç”Ÿæˆç»“æœæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ€»ä½“æè¿°
        function getOverallDescription(score) {
            if (score < 25) return 'æ‚¨çš„åˆ›ä¼¤é£é™©æŒ‡æ•°è¾ƒä½ï¼Œè¡¨æ˜æ‚¨åœ¨å¤§å¤šæ•°æ–¹é¢å…·æœ‰è‰¯å¥½çš„å¿ƒç†éŸ§æ€§ã€‚';
            if (score < 50) return 'æ‚¨çš„åˆ›ä¼¤é£é™©æŒ‡æ•°ä¸­ç­‰ï¼Œå»ºè®®å…³æ³¨å¯èƒ½å­˜åœ¨çš„å¿ƒç†åˆ›ä¼¤å¹¶è€ƒè™‘ä¸“ä¸šæŒ‡å¯¼ã€‚';
            if (score < 75) return 'æ‚¨çš„åˆ›ä¼¤é£é™©æŒ‡æ•°è¾ƒé«˜ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡è¿›è¡Œæ·±å…¥è¯„ä¼°ã€‚';
            return 'æ‚¨çš„åˆ›ä¼¤é£é™©æŒ‡æ•°å¾ˆé«˜ï¼Œå¼ºçƒˆå»ºè®®å°½å¿«å¯»æ±‚ä¸“ä¸šå¿ƒç†å¸®åŠ©å’Œæ”¯æŒã€‚';
        }

        // è·å–é£é™©ç­‰çº§
        function getRiskLevel(score) {
            if (score < 25) return { level: 'low', label: 'ä½é£é™©', color: '#28A745' };
            if (score < 50) return { level: 'medium', label: 'ä¸­é£é™©', color: '#FFC107' };
            if (score < 75) return { level: 'high', label: 'é«˜é£é™©', color: '#DC3545' };
            return { level: 'severe', label: 'ä¸¥é‡é£é™©', color: '#8B0000' };
        }

        // ç”Ÿæˆé›·è¾¾å›¾
        function generateRadarChart(dimensionScores) {
            try {
                const canvas = document.getElementById('trauma-radar-chart');
                if (!canvas) {
                    console.error('Chart canvas not found');
                    return;
                }
                
                // é”€æ¯ç°æœ‰å›¾è¡¨å®ä¾‹
                if (chartInstance) {
                    chartInstance.destroy();
                }
                
                const ctx = canvas.getContext('2d');
                const labels = testData.dimensions.map(d => d.name);
                const data = testData.dimensions.map(d => Math.round((dimensionScores[d.id] || 0) / 3 * 100));
                
                chartInstance = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'åˆ›ä¼¤é£é™©æŒ‡æ•° (%)',
                            data: data,
                            backgroundColor: 'rgba(45, 106, 106, 0.1)',
                            borderColor: '#2D6A6A',
                            borderWidth: 2,
                            pointBackgroundColor: '#2D6A6A',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#2D6A6A'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { stepSize: 20 }
                            }
                        },
                        plugins: {
                            legend: { display: true }
                        }
                    }
                });
                
                console.log('Radar chart generated successfully');
            } catch (error) {
                console.error('Error generating radar chart:', error);
                showError('ç”Ÿæˆå›¾è¡¨æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆè¯¦ç»†åˆ†æ
        function generateDetails(dimensionScores) {
            try {
                elements.detailsGrid.innerHTML = '';
                
                testData.dimensions.forEach(dimension => {
                    const score = Math.round((dimensionScores[dimension.id] || 0) / 3 * 100);
                    const riskLevel = getRiskLevel(score);
                    
                    const detailCard = document.createElement('div');
                    detailCard.className = 'detail-card';
                    
                    detailCard.innerHTML = `
                        <h4>${dimension.name}</h4>
                        <div class="score-indicator">
                            <span class="score-badge ${riskLevel.level}">${riskLevel.label}</span>
                            <span>${score}%</span>
                        </div>
                        <p>${getDimensionDescription(dimension.id, score)}</p>
                    `;
                    
                    elements.detailsGrid.appendChild(detailCard);
                });
                
                console.log('Details generated successfully');
            } catch (error) {
                console.error('Error generating details:', error);
                showError('ç”Ÿæˆè¯¦ç»†åˆ†ææ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç»´åº¦æè¿°
        function getDimensionDescription(dimensionId, score) {
            const descriptions = {
                'childhood': score < 25 ? 'ç«¥å¹´æœŸåˆ›ä¼¤ç›¸å¯¹è¾ƒå°‘ï¼Œå¯èƒ½å…·æœ‰è‰¯å¥½çš„æ—©æœŸä¾æ‹å…³ç³»ã€‚' : 'å¯èƒ½å­˜åœ¨ç«¥å¹´æœŸåˆ›ä¼¤ç»å†ï¼Œå»ºè®®å…³æ³¨å…¶å¯¹å½“å‰ç”Ÿæ´»çš„å½±å“ã€‚',
                'emotional': score < 25 ? 'æƒ…æ„Ÿå…³ç³»ç›¸å¯¹ç¨³å®šï¼Œæœªç»å†é‡å¤§æƒ…æ„Ÿåˆ›ä¼¤ã€‚' : 'å¯èƒ½å­˜åœ¨æƒ…æ„Ÿåˆ›ä¼¤ï¼Œéœ€è¦å…³æ³¨äººé™…å…³ç³»çš„ä¿®å¤ã€‚',
                'interpersonal': score < 25 ? 'äººé™…å…³ç³»è‰¯å¥½ï¼Œæœªç»å†ä¸¥é‡çš„ç¤¾äº¤åˆ›ä¼¤ã€‚' : 'å¯èƒ½å­˜åœ¨äººé™…å…³ç³»åˆ›ä¼¤ï¼Œå»ºè®®åŠ å¼ºç¤¾äº¤æ”¯æŒã€‚',
                'acute': score < 25 ? 'æœªç»å†ä¸¥é‡çš„æ€¥æ€§åˆ›ä¼¤äº‹ä»¶ã€‚' : 'å¯èƒ½ç»å†æ€¥æ€§åˆ›ä¼¤äº‹ä»¶ï¼Œéœ€è¦å…³æ³¨åˆ›ä¼¤åæ¢å¤ã€‚',
                'chronic': score < 25 ? 'æ…¢æ€§å‹åŠ›æ°´å¹³è¾ƒä½ï¼Œç”Ÿæ´»çŠ¶æ€ç›¸å¯¹ç¨³å®šã€‚' : 'å¯èƒ½å­˜åœ¨é•¿æœŸæ…¢æ€§å‹åŠ›ï¼Œå»ºè®®å¯»æ±‚å‹åŠ›ç®¡ç†æ”¯æŒã€‚',
                'complex': score < 25 ? 'åˆ›ä¼¤ç»å†ç›¸å¯¹å•ä¸€ï¼Œæœªç»å†å¤æ‚çš„åˆ›ä¼¤æ¨¡å¼ã€‚' : 'å¯èƒ½ç»å†å¤åˆæ€§åˆ›ä¼¤ï¼Œéœ€è¦ç»¼åˆæ€§çš„ä¸“ä¸šæ”¯æŒã€‚',
                'vicarious': score < 25 ? 'è¾ƒå°‘å—åˆ°æ¬¡çº§åˆ›ä¼¤å½±å“ã€‚' : 'å¯èƒ½å› æ¥è§¦ä»–äººåˆ›ä¼¤è€Œå—åˆ°å½±å“ï¼Œå»ºè®®å»ºç«‹å¥åº·ç•Œé™ã€‚',
                'attachment': score < 25 ? 'ä¾æ‹å…³ç³»ç›¸å¯¹å¥åº·ï¼Œæ—©æœŸå…³çˆ±å……è¶³ã€‚' : 'å¯èƒ½å­˜åœ¨ä¾æ‹åˆ›ä¼¤ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šæ”¯æŒè¿›è¡Œä¿®å¤ã€‚'
            };
            return descriptions[dimensionId] || 'éœ€è¦ä¸“ä¸šè¯„ä¼°ç¡®å®šå…·ä½“å½±å“ã€‚';
        }

        // ç”Ÿæˆå»ºè®®
        function generateRecommendations(dimensionScores) {
            try {
                const highRiskDimensions = Object.entries(dimensionScores)
                    .filter(([id, score]) => (score / 3 * 100) >= 50)
                    .map(([id]) => id);
                
                let recommendations = '';
                
                if (highRiskDimensions.length === 0) {
                    recommendations = `
                        <div class="recommendation-item">
                            <h4>ç»´æŒå¿ƒç†å¥åº·</h4>
                            <p>ç»§ç»­ç»´æŠ¤è‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œä¿æŒç¤¾äº¤è”ç³»ï¼ŒåŸ¹å…»å¥åº·çš„åº”å¯¹æœºåˆ¶ã€‚</p>
                        </div>
                    `;
                } else {
                    recommendations = `
                        <div class="recommendation-item">
                            <h4>å¯»æ±‚ä¸“ä¸šæ”¯æŒ</h4>
                            <p>å»ºè®®å¯»æ‰¾ä¸“ä¸šçš„å¿ƒç†å’¨è¯¢å¸ˆè¿›è¡Œè¿›ä¸€æ­¥çš„è¯„ä¼°å’Œæ”¯æŒï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹${highRiskDimensions.length}ä¸ªé«˜é£é™©ç»´åº¦çš„åˆ›ä¼¤ã€‚</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>å»ºç«‹æ”¯æŒç³»ç»Ÿ</h4>
                            <p>ä¸å®¶äººæœ‹å‹åˆ†äº«æ‚¨çš„æ„Ÿå—ï¼Œå¯»æ±‚ç†è§£å’Œæ”¯æŒï¼Œå‚åŠ ç›¸å…³çš„æ”¯æŒå°ç»„ã€‚</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>è‡ªæˆ‘å…³çˆ±å®è·µ</h4>
                            <p>ç»ƒä¹ æ­£å¿µå†¥æƒ³ã€å®šæœŸè¿åŠ¨ã€ä¿æŒå……è¶³ç¡çœ ï¼ŒåŸ¹å…»å¥åº·çš„åº”å¯¹æŠ€å·§ã€‚</p>
                        </div>
                    `;
                }
                
                elements.recommendationsCard.innerHTML = recommendations;
                console.log('Recommendations generated successfully');
            } catch (error) {
                console.error('Error generating recommendations:', error);
                showError('ç”Ÿæˆå»ºè®®æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ä¸‹è½½æŠ¥å‘Š
        function downloadReport() {
            try {
                const reportData = {
                    timestamp: new Date().toISOString(),
                    answers: answers,
                    completed: testCompleted
                };
                
                const dataBlob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `å¿ƒç†åˆ›ä¼¤è¯„ä¼°æŠ¥å‘Š_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                alert('æŠ¥å‘Šå·²ä¸‹è½½ä¸ºJSONæ–‡ä»¶ã€‚å¦‚éœ€æ›´è¯¦ç»†çš„åˆ†ææŠ¥å‘Šï¼Œå»ºè®®å’¨è¯¢ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡æœºæ„ã€‚');
            } catch (error) {
                showError('ä¸‹è½½æŠ¥å‘Šæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é‡æ–°å¼€å§‹æµ‹è¯•
        function restartTest() {
            try {
                console.log('Restarting test...');
                initTest();
                showPage('intro');
            } catch (error) {
                showError('é‡æ–°å¼€å§‹æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é”®ç›˜å¯¼èˆª
        document.addEventListener('keydown', function(e) {
            if (elements.testPage.classList.contains('active')) {
                if (e.key === 'ArrowRight' || e.key === ' ') {
                    e.preventDefault();
                    if (!elements.nextBtn.disabled) nextQuestion();
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    if (!elements.prevBtn.disabled) previousQuestion();
                }
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('DOM loaded, initializing application...');
                initTest();
                console.log('Application initialized successfully');
            } catch (error) {
                showError('åˆå§‹åŒ–åº”ç”¨æ—¶å‡ºé”™ï¼š' + error.message);
            }
        });

        // Chart.jsåŠ è½½æ£€æŸ¥
        window.addEventListener('load', function() {
            if (typeof Chart === 'undefined') {
                showError('å›¾è¡¨åº“åŠ è½½å¤±è´¥ï¼Œé›·è¾¾å›¾åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨');
            }
        });
    </script>
</body>
</html>